{{/*
  目录卡片组件

  显示文章目录，支持当前阅读位置高亮和点击跳转

  @context {page} . 当前文章页面对象
*/}}

<!-- 目录卡片遮罩层 -->
<div
  id="toc-overlay"
  class="fixed inset-0 bg-black/50 backdrop-blur-sm z-40 opacity-0 pointer-events-none transition-all duration-300"
  role="dialog"
  aria-modal="true"
  aria-labelledby="toc-title">
</div>

<!-- 目录卡片 -->
<div
  id="toc-card"
  class="fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-50 w-full max-w-md mx-4 opacity-0 scale-95 pointer-events-none transition-all duration-300"
  role="dialog"
  aria-modal="true"
  aria-labelledby="toc-title">

  <div class="bg-card border border-border rounded-xl shadow-xl overflow-hidden">

    <!-- 卡片头部 -->
    <div class="flex items-center justify-between p-4 border-b border-border bg-muted/30">
      <div class="flex items-center gap-3">
        {{ partial "icon.html" (dict "name" "list" "size" "md" "ariaLabel" "") }}
        <h2 id="toc-title" class="text-lg font-semibold text-foreground">
          {{ i18n "toc.title" | default "目录" }}
        </h2>
      </div>

      <!-- 关闭按钮 -->
      <button
        id="toc-close"
        class="p-2 rounded-lg text-muted-foreground
        hover:text-primary hover:bg-primary/10 hover:-translate-y-0.5 hover:scale-105
        transition-all duration-200 ease-out
        focus:outline-none focus:ring-2 focus:ring-primary/20"
        title="{{ i18n "toc.close" | default "关闭" }}"
        aria-label="{{ i18n "toc.close" | default "关闭目录" }}">
        {{ partial "icon.html" (dict "name" "close" "size" "sm" "ariaLabel" "") }}
      </button>
    </div>

    <!-- 目录内容 -->
    <div class="max-h-96 overflow-y-auto p-4">
      <nav id="toc-nav" aria-label="{{ i18n "toc.navigation" | default "文章目录导航" }}">
        {{- if .TableOfContents }}
          <!-- Hugo 生成的目录 -->
          <div id="toc-content">
            {{ .TableOfContents }}
          </div>
        {{- else }}
          <!-- 空状态 -->
          <div class="text-center py-8 text-muted-foreground">
            <div class="w-12 h-12 mx-auto mb-3 rounded-full bg-muted/50 flex items-center justify-center">
              {{ partial "icon.html" (dict "name" "text" "size" "md" "ariaLabel" "") }}
            </div>
            <p class="text-sm">{{ i18n "toc.empty" | default "此文章没有标题" }}</p>
          </div>
        {{- end }}
      </nav>
    </div>

    <!-- 卡片底部 -->
    <div class="px-4 py-3 border-t border-border bg-muted/20">
      <div class="text-center text-xs text-muted-foreground">
        <span>{{ i18n "toc.tip" | default "点击标题快速跳转" }}</span>
      </div>
    </div>

  </div>
</div>
